{% extends "mobile_base.html" %}

{% block title %}MidWhereAh - Find Your Midpoint{% endblock %}

{% block head %}
{{ super() }}
<!-- Page specific CSS -->
<link rel="stylesheet" href="{{ url_for('static', filename='css/profile.css') }}">
{% endblock %}

{% block content %}
<div class="profile-container">
  <!-- Profile Header -->
  <div class="profile-header">
    <h1 class="profile-name">YOURNAME</h1>
  </div>
  
  <!-- Profile Avatar -->
  <div class="profile-avatar-container">
    <div class="profile-avatar">
      <img src="{{ url_for('static', filename='images/profile_photo-placeholder.png') }}" alt="Profile Picture">
    </div>
    <p class="profile-username">@yourusername</p>
  </div>
  
  <!-- Profile Menu Options -->
  <div class="profile-menu">
    <a class="profile-menu-item">
      <div class="menu-icon">
        <i class="fas fa-map-marker-alt"></i>
      </div>
      <span>Addresses</span>
    </a>
    
    <a class="profile-menu-item">
      <div class="menu-icon">
        <i class="fas fa-car"></i>
      </div>
      <span>Transport Mode</span>
    </a>
    
    <a class="profile-menu-item">
      <div class="menu-icon">
        <i class="fas fa-cog"></i>
      </div>
      <span>Settings</span>
    </a>
    
    <a href="/logout" class="profile-menu-item">
      <div class="menu-icon">
        <i class="fas fa-sign-out-alt"></i>
      </div>
      <span>Log out</span>
    </a>
  </div>
</div>
<!-- Bottom Navigation -->
<div class="group-col bottom-container center">
  <div class="bottom-navigation">
    <div class="nav-item" data-page="home">
      <i class="fas fa-home"></i>
      <span>Home</span>
    </div>
    <div class="nav-item" data-page="compass">
      <i class="fas fa-compass"></i>
      <span>Explore</span>
    </div>
    <div class="nav-item nav-item-center" data-page="create">
      <div class="center-fab">
        <i class="fas fa-plus"></i>
      </div>
    </div>
    <div class="nav-item" data-page="groups">
      <i class="fas fa-users"></i>
      <span>Groups</span>
    </div>
    <div class="nav-item active" data-page="profile">
      <i class="fas fa-user"></i>
      <span>Profile</span>
    </div>
  </div>
</div>
{% endblock %}


{% block scripts %}
<!-- Load mobile.js and maps.js first -->
<script src="{{ url_for('static', filename='js/maps.js') }}"></script>
<script src="{{ url_for('static', filename='js/group.js') }}"></script>

<!-- Custom script for profile page navigation -->
<script>
  // Override the setupBottomNavigation function from group.js for this page
  document.addEventListener('DOMContentLoaded', function() {
    // Get all nav items
    const navItems = document.querySelectorAll('.nav-item');
    
    // Remove existing click listeners (important to prevent double-binding)
    navItems.forEach(item => {
      const clone = item.cloneNode(true);
      item.parentNode.replaceChild(clone, item);
    });
    
    // Re-add click listeners with proper authentication check
    document.querySelectorAll('.nav-item').forEach(item => {
      item.addEventListener('click', function() {
        const page = this.getAttribute('data-page');
        
        if (page === 'home') {
          // Check authentication before redirecting
          if (firebase.auth().currentUser) {
            window.location.href = '/app';
          } else {
            window.location.href = '/login';
          }
        } else if (page === 'groups') {
          window.location.href = '/groups';
        } else if (page === 'profile') {
          window.location.href = '/profile';
        } else if (page === 'create') {
          // Handle create action if needed
        }
      });
    });
  });
</script>

<!-- Load Google Maps API following official best practices -->

{% endblock %}