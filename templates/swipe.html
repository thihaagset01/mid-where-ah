<!-- templates/swipe.html -->
{% extends "mobile_base.html" %}

{% block title %}Swipe Voting - MidWhereAh{% endblock %}

{% block head %}
{{ super() }}
<link rel="stylesheet" href="{{ url_for('static', filename='css/swipe.css') }}">
{% endblock %}

{% block content %}
<!-- Top Header with Toggle -->
<header class="swipe-header">
    <div class="container-fluid">
        <div class="d-flex justify-content-between align-items-center">
            <button class="btn btn-link p-0" onclick="goBackToVenues()">
                <i class="fas fa-arrow-left"></i> Back
            </button>
            <h1 class="h5 mb-0">
                <i class="fas fa-heart me-2 text-danger"></i>
                Swipe to Vote
            </h1>
            <div style="width: 40px;"></div> <!-- Spacer -->
        </div>
    </div>
</header>

<!-- Member Avatars Row -->
<div class="members-row" id="members-row">
    <div class="members-container" id="members-container">
        <!-- Member avatars will be populated by JS -->
    </div>
</div>

<!-- Main Swipe Area -->
<div class="swipe-area">
    <!-- Loading State -->
    <div class="loading-container" id="loading-container">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading venues...</span>
        </div>
        <p class="mt-3">Loading venues for voting...</p>
    </div>

    <!-- Empty State -->
    <div class="empty-container" id="empty-container" style="display: none;">
        <div class="empty-state">
            <i class="fas fa-heart-broken fa-4x text-muted mb-3"></i>
            <h4>No More Venues</h4>
            <p class="text-muted">You've voted on all available venues!</p>
            <button class="btn btn-primary btn-lg mt-3" onclick="showResults()">
                <i class="fas fa-trophy me-2"></i>
                View Results
            </button>
        </div>
    </div>

    <!-- Swipe Container -->
    <div class="swipe-container" id="swipe-container">
        <!-- Venue cards will be dynamically inserted here -->
    </div>

    <!-- Swipe Instructions (shows initially) -->
    <div class="swipe-instructions" id="swipe-instructions">
        <div class="instruction-content">
            <div class="swipe-arrows">
                <i class="fas fa-arrow-left text-danger"></i>
                <i class="fas fa-hand-point-up fa-2x"></i>
                <i class="fas fa-arrow-right text-success"></i>
            </div>
            <p class="instruction-text">Swipe your preferences</p>
            <p class="instruction-subtext">Swipe left to skip â€¢ Swipe right to like</p>
        </div>
    </div>
</div>

<!-- Action Buttons -->
<div class="action-buttons">
    <button class="action-btn dislike-btn" id="dislike-btn" onclick="swipeLeft()">
        <i class="fas fa-times"></i>
    </button>
    <button class="action-btn like-btn" id="like-btn" onclick="swipeRight()">
        <i class="fas fa-heart"></i>
    </button>
</div>

<!-- Progress Bar -->
<div class="progress-container">
    <div class="progress">
        <div class="progress-bar bg-primary" id="progress-bar" role="progressbar" style="width: 0%"></div>
    </div>
    <div class="progress-text" id="progress-text">0 of 0 venues</div>
</div>

<!-- Toggle Button (matches venues page) -->
<button class="nav-toggle-btn" id="nav-toggle-btn" onclick="toggleToResults()" title="View Results">
    <i class="fas fa-trophy"></i>
</button>

<!-- Vote Confirmation Modal -->
<div class="modal fade" id="vote-modal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-body text-center">
                <div class="vote-result-icon" id="vote-result-icon">
                    <i class="fas fa-heart fa-3x text-success"></i>
                </div>
                <h5 class="mt-3" id="vote-result-text">You liked this venue!</h5>
                <p class="text-muted" id="vote-result-venue">Venue name</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
<script src="{{ url_for('static', filename='js/swipe.js') }}"></script>
<script>
// Initialize swipe interface when page loads
document.addEventListener('DOMContentLoaded', function() {
    const groupId = '{{ group_id }}';
    initializeSwipeInterface(groupId);
});
</script>
{% endblock %}